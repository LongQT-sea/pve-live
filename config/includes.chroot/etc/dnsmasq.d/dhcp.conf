# If you don't want dnsmasq to read /etc/resolv.conf or any other
# file, getting its servers from this file instead.
no-resolv

# Use Adguard DNS server
server=94.140.14.14
server=94.140.15.15
server=2a10:50c0::ad1:ff
server=2a10:50c0::ad2:ff

# If you want dnsmasq to listen for DHCP and DNS requests only on
# specified interfaces (and the loopback) give the name of the
# interface (eg eth0) here.
# Repeat the line for more than one interface.
interface=vmbr1
#interface=vmbr0.20

# Or you can specify which interface _not_ to listen on
except-interface=lo

#bind-dynamic

# On systems which support it, dnsmasq binds the wildcard address,
# even when it is listening on only some interfaces. It then discards
# requests that it shouldn't reply to. This has the advantage of
# working even when interfaces come and go and change address. If you
# want dnsmasq to really bind only the interfaces it is listening on,
# uncomment this option. About the only time you may need this is when
# running another nameserver on the same machine.
bind-interfaces

# enable IPv6 Route Advertisements
enable-ra

# Construct a valid IPv6 range from reading the address set on the interface.
# The ::1 part refers to the ifid in dhcp6c.conf. Make sure you get this right or dnsmasq will get confused.
dhcp-range=tag:vmbr1,::1,constructor:vmbr1, ra-names, 12h

# To enable dnsmasq's DHCP server functionality.
dhcp-range=set:vmbr1,172.16.99.10,172.16.99.199,255.255.255.0,12h
#dhcp-range=set:br0.10,192.168.200.10,192.168.200.99,255.255.255.0,12h

expand-hosts

# Set the domain for dnsmasq. this is optional, but if it is set, it
# does the following things.
# 1) Allows DHCP hosts to have fully qualified domain names, as long
#     as the domain part matches this setting.
# 2) Sets the "domain" DHCP option thereby potentially setting the
#    domain of all systems configured by DHCP
# 3) Provides the domain part for "expand-hosts"
domain=lab,172.16.99.0/24
#domain=lan,192.168.200.0/24

# Add local-only domains here, queries in these domains are answered
# from /etc/hosts or DHCP only.
local=/lab/
local=/lan/

# Always give the host with Ethernet address 76:cd:be:0d:7b:39
# IP address 10.0.0.3 and infinite lease
#dhcp-host=76:cd:be:0d:7b:39,10.0.0.3,infinite

# Limits maximum number of DHCP leases to prevent denial of service attack.
dhcp-lease-max=200

# Set the DNS cachesize here.
cache-size=200

# Disable negative caching.
no-negcache

# Should be set when dnsmasq is definitely the only DHCP server on a network.
dhcp-authoritative

# Send an empty WPAD option. This may be REQUIRED to get Windows 7 to behave.
dhcp-option=252,"\n"

# Send microsoft-specific option to tell windows to release the DHCP lease
# when it shuts down. Note the "i" flag, to tell dnsmasq to send the
# value as a four-byte integer - that's what microsoft wants.
dhcp-option=vendor:MSFT,2,1i

# This fixes a security hole. see CERT Vulnerability VU#598349
dhcp-name-match=set:wpad-ignore,wpad
dhcp-ignore-names=tag:wpad-ignore

# Never forward plain names (without a dot or domain part)
domain-needed
# Never forward addresses in the non-routed address spaces.
bogus-priv

localise-queries

# RFC6761 included configuration file for dnsmasq

server=/bind/
server=/invalid/
server=/local/
server=/localhost/
server=/onion/
server=/test/